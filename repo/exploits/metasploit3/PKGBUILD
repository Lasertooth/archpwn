# Contributor: Francesco Piccinno <stack.box@gmail.com>
# Contributor: Valentin Churavy <v.churavy@gmail.com>

pkgname=metasploit3
pkgver=3.3.2
pkgrel=2
pkgdesc="The Metasploit Framework is an advanced open-source platform for developing, testing, and using exploit code"
depends=('ruby' 'ruby-gtk2' 'ruby-libglade')
makedepends=('subversion')
groups=('archpwn' 'archpwn-exploits')
source=(http://www.metasploit.com/releases/framework-$pkgver.tar.bz2)
url="http://www.metasploit.com/"
md5sums=('004392bc2ca030a7a0822fe54f2f80ec')
license=('custom')
arch=('i686' 'x86_64')

build() {
  cd $srcdir/msf3/

  echo "Updating ..." && svn up

  rm _EXTRACTED_

  install -d $pkgdir/usr/share/$pkgname/ && \
  install -d $pkgdir/usr/share/licenses/$pkgname/ &&
  install -d $pkgdir/etc/profile.d/ &&
  cp -r * $pkgdir/usr/share/$pkgname/ &&
  install -Dm644 README $pkgdir/usr/share/licenses/metasploit3/README || return 1

  echo "export PATH=\$PATH:/usr/share/$pkgname/" > $pkgdir/etc/profile.d/$pkgname.sh
  chmod 0755 $pkgdir/etc/profile.d/$pkgname.sh
}
